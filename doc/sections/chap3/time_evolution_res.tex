\documentclass{subfiles}

\begin{document}
\section{Time-evolution of quantum gate protocols}\label{sec:time_evolution}
We simulate the time-dependent Schr√∂dinger equation for two distinguishable particles in our double-well Morse potential, in accordance with the procedural framework outlined in Section \ref{sec:summary_workflow}. The system is built in the Sinc-DVR basis using, and mapped into the reduced Hartree basis as described in Section \ref{sec:Hartree_method}. We choose eigenvectors of Hamiltonian in the optimal parameters for configuation $C_I$ as our measurement (computational) basis, as the eigenvectors of this configuration have complete overlap with the logical basis states $\ket{ij}$, i.e the product states of the two particles. Our ramping protocol (Section \ref{sec:ramping_protocol}) smoothly ramps from configuration $C_I$ (non-degenerate qubit levels, zero entanglement) to configuration $C_{II}$ (close-to degeneracy in first excitations, high entanglement), and back. In what follows, we present the results of our time-evolution simulations, focusing on the state populations throughout. First we shall present a minimal "two-level" model of the system ($l=2$ basis functions per well) to demonstrate the idealized gate action and entanglement generation, and then we will present the full simulation ($l=4$ basis functions per well) to investigate the effects of higher-order excitations, assess higher-order leakage and its impact on gate fidelity. The discussions that follow will focus on the implications of these results for quantum control protocols and the feasibility of implementing a two-qubit gate operation in a real-world experimental setup. Time-scales in the simulations are given in atomic units (a.u.), where $1$ a.u. corresponds to approximately $2.42 \times 10^{-17}$ seconds (Hartree time), or about $58.7$ attoseconds. The total simulation times will be converted as needed to SI units, and the time steps are set to $\Delta t = 0.1$ a.u. for all simulations, ensuring a sufficiently fine resolution for capturing the dynamics of the system.

\subsection{Two-level model: Idealized gate action and entanglement generation}
In the reduced four-dimensional Hilbert space spanned by the product states $\{\ket{00}, \ket{01}, \ket{10}, \ket{11}\}$, we simulate the time evolution using the unitary time-evolution operator (Section \ref{sec:time_evolution_operator}) for the two-particle system. Because only the first four states are active, there is no possibility for population leakage to higher order states outside the qubit subspace, and we can expect the system to behave as a perfect two-qubit gate. Figure \ref{fig:time_evolution_2_basefunctions} shows the time evolution of the state populations for the two-level model, where we've plotted the populations 
\begin{align*}
    P_{ij} = |\braket{ij| \psi(t)}|^2,
\end{align*}
for each logical state $\ket{ij}$ in the qubit manifold, as a function of time.
\begin{figure}[h!]
    \centering
    \includegraphics[width=1.0\textwidth]{figs/time_evolution_2_basefunctions_1806.pdf}
    \caption{Evolution of the state populations for the two-level model of the Morse double-well potential, showing the idealized gate action and entanglement generation. The populations of the logical states $\ket{10}$ and $\ket{01}$ oscillate in a coherent manner, indicating a successful SWAP-like operation. The populations of the states $\ket{00}$ and $\ket{11}$ remain constant. The parameters used for the ramping protocol are $T_{\text{start}} = 10.0$ a.u., $T_{\text{end}} = 500.0$ a.u, $T_{\text{up}} = 50.0$ a.u., $T_{\text{down}} = 50.0$ a.u., and the hold time $T_{\text{hold}} = 11125.0$ a.u. The ramping protocol is applied to the Morse double-well potential parameters for configuration $C_I$ and $C_{II}$, as described in Section \ref{sec:optimization_result}. The simulation is run for a total time of $T_{\text{total}} = 11860.0$ a.u., with a time step of $\Delta t = 0.1$ a.u. Converted using the atomic units, this corresponds to a total time $T_{\text{total}}=0.287$ picoseconds. \textcolor{red}{TODO: Maybe re-do figure to get better swap? Or should we save that to the full system perhaps?}}
    \label{fig:time_evolution_2_basefunctions}
\end{figure}
\\ 

The figure shows how the populations initially is clearly separated, with clean energy eigenfunctions (e.g $\braket{\psi_0(0)|00} = 1$), before the ramping procedure is initiated at $t = 50.0$ a.u. During the ramp we see a slight nudge in the populations, where there is some leakage between states but this is negligable. After ramp is completeted, the 1st and 2nd excited states $\psi_1(t)$ and $\psi_2(t)$, initially in $\ket{01}$ and $\ket{10}$ respectively, oscillate coherently between the two states, indicating a successful SWAP-like operation. The entanglement is generated as the populations of the two energy eigenstates mix, and swap, with a uniform frequency of oscillation. This clean SWAP-like behaviour serves as a proof of concept for the two-qubit gate operation in our Morse double-well potential, demonstrating that the system can be controlled to perform a coherent mixing of the logical states $\ket{10}$ and $\ket{01}$, thus generating entanglement. At the end of the simulation the energy eigenfunctions are in a superposition,
\begin{align*}
    \ket{\psi_1(t_{\text{end}})} &\approx 0.2885 \ket{01} + 0.7115 \ket{10}, \\
    \ket{\psi_2(t_{\text{end}})} &\approx 0.7115 \ket{01} + 0.2885 \ket{10},
\end{align*}
with negligible contributions from the states $\ket{00}$ and $\ket{11}$, which remain (almost) constant throughout the simulation. To improve upon this result, we can investigate various time-scales for the simulation.

We also identify the importance of optimizing the ramping procedure to ensure that the populations of the states $\ket{00}$ and $\ket{11}$ remain consistent with our desired gate operation post ramp, as the populations oscillates in time. Carefully constructed ramping protocols can be the difference between a succesful (total) swap between the two states, a perfect mixing where the two states are equally populated, or a failed operation where the states go back to their original population after the gate operation has been performed. Due to the simple nature of the two-level model, we used the direct matrix exponentiation method to compute the time-evolution operator, which is efficient and fast for smaller systems. 
\textcolor{red}{TODO: Add more discussions? We should also check the fidelity of the gate, i.e, what is the Unitary matrix at the end of our simulation - does it correspond to a perfect SWAP gate? We must also quantify the population of states at $t_{\text{end}}$ and add that to our discussion to show the success beyond just the qualitative analysis of the plot.}


\subsection{Four-level model: Higher-order excitations and gate fidelity}
In the four-level model, we include higher-order excitations by using $l=4$ basis functions per well, allowing us to investigate the effects of higher-order excitations on the gate operation, and reveal realistic limitations of the two-qubit gate operation in our Morse double-well potential. We must now optimize more carefully to avoid off-diagonal couplings that lead to leakage to higher-order states that would otherwise spoil the two-qubit gate protocol. Leakage between the qubit manifold $\{\ket{01}, \ket{10}\}$ and the higher-order spectator manifolds can lead to unwanted population transfer, instability during evolution, and de-phasing effects that can significantly reduce the fidelity of the gate
operation. \textcolor{red}{TODO: ADd more on this discuttion, and maybe move to the end of section?: "There is also the aspect of optimizing the ramping protocol to avoid non-ideal transitions and de-phasing, and the trade-off between between adiabaticity and speed will be the subject of further studies." }

\begin{figure}[h!]
    \centering
    \includegraphics[width=1.0\textwidth]{figs/time_evolution_4_basefunctions_2106.pdf}
    \caption{Evolution of the state populations for the four-level model of the Morse double-well potential, showing the effects of higher-order excitations on the gate operation. The populations of the energy eigenstates $\ket{\psi_0(t)}$ and $\ket{\psi_1(t)}$ oscillate in a coherent manner, but due to the low coupling term $J=H[\psi_0, \psi_1]$ the oscillations are elongated. The coherent oscillations do indicate successful SWAP-like operation, but we note that the mixture is not clean. During evolution, there is possibly some leakage to higher order states not present in the plot.
    The parameters used in the ramping protocol are $T_{\text{start}} = 10.0$ a.u., $T_{\text{end}} = 1500.0$ a.u, $T_{\text{up}} = 200.0$ a.u., $T_{\text{down}} = 200.0$ a.u., and the hold time $T_{\text{hold}} = 22 309.0$ a.u. The ramping protocol is applied to the Morse double-well potential parameters for configuration $C_I$ and $C_{II}$, as described in Section \ref{sec:optimization_result}. The simulation is run for a total time of $T_{\text{total}} \approx 24 500.0$ a.u., with a time step of $\Delta t = 0.1$ a.u. Converted using the atomic units, this corresponds to a total time $T_{\text{total}}=5.9$ nanoseconds.
    }
    \label{fig:time_evolution_4_basefunctions}
\end{figure}
In figure \ref{fig:time_evolution_4_basefunctions} we show the time evolution of the state populations for the four-level model, where we observe similar behaviour as in the idealised two-level model, but with some leakage to higher-order states. The populations of the eigenstates $\ket{\psi_0(t)}$ and $\ket{\psi_1(t)}$ oscillate in a coherent manner, indicating a successful SWAP-like operation. The final state population of the two energy eigenstates are
\begin{align*}
    \ket{\psi_1(t_{\text{end}})} &\approx 0.9420 \ket{01} + 0.0520 \ket{10}  \\
    \ket{\psi_2(t_{\text{end}})} &\approx 0.0520 \ket{01} + 0.9543 \ket{10},
\end{align*}
and we note that there is some minor leakage to higher order states - which is why they are approximations. 
\\
Figure \ref{fig:time_evolution_4_basefunctions} shows the protocol with optimized hold time to match the Rabi oscillation for a successful swap of the logical states. I.e since the Rabi oscillation frequency is given by the coupling term $J = H[\psi_1, \psi_2]$, through $P_{01\to10} = \sin^2(J t)$, we can optimize the hold time to be a multiple of the Rabi oscillation period $T_R = \pi/(4J)$. With a coupling term of $J \approx 7.0 \times 10^{-5}$ a.u., we find the Rabi oscillation period to be $T_R \approx 22400$ a.u., and we set the hold time accordingly. We note that the oscillations are elongated compared to the two-level model, indicating that the coupling term is lower than in the idealized case. This is expected, as we have higher-order excitations that can lead to leakage and de-phasing effects. \textcolor{red}{TODO: Add more discussion and move onto physical realisation of this evolution}

\end{document}